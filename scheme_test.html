<!DOCTYPE html>
<html>

<head>
    <title>welcome</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--<meta name="viewport" content="user-scalable=no" />-->

    <meta property="og:title" content="타이틀">
    <meta property="og:description" content="디스크립션 데이터">
    <meta property="og:image" content="https://img.insight.co.kr/static/2019/04/24/700/16l9qxr1l83y0jy060ow.jpg">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="comico">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8/dist/sweetalert2.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@8/dist/sweetalert2.min.css" id="theme-styles">
    <style type="text/css">
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #ffffff;
            margin: 0;
            padding: 5px;
            box-sizing: border-box;
        }

        img {
            border: 2px solid #cccccc;
            border-radius: 8px;
            padding: 4px;
            transition: border-color 0.3s ease;
        }

        /* li 스타일 */
        li {
            list-style-type: none;
            margin-bottom: 10px;
        }

        li a {
            text-decoration: none;
            color: #007bff;
            font-weight: 600;
        }

        li a:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        /* 버튼 스타일 */
        button {
            background-color: #007bff;
            color: white;
            font-size: 16px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        button:active {
            background-color: #004085;
            transform: translateY(0);
        }

        button:disabled {
            background-color: #c6c6c6;
            cursor: not-allowed;
        }

        /* input 스타일 */
        input[type="text"],
        input[type="password"],
        input[type="email"],
        input[type="number"] {
            width: 100%;
            padding: 5px;
            margin: 0;
            border: 1px solid #ddd;
            border-radius: 0px;
            font-size: 11px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="password"]:focus,
        input[type="email"]:focus,
        input[type="number"]:focus {
            border-color: #007bff;
            outline: none;
        }

        input::placeholder {
            color: #aaa;
        }

        /* textarea 스타일 */
        textarea {
            width: 95%;
            padding: 5px;
            margin: 0;
            border: 1px solid #ddd;
            border-radius: 0px;
            font-size: 11px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            border-color: #007bff;
            outline: none;
        }

        textarea::placeholder {
            color: #aaa;
        }

        #outputImage {
        	margin: 5px;
            max-width: 95%;
            height: auto;
        }
    </style>

    <script type="text/javascript">
        function checkMobile() {
            var agent = navigator.userAgent.toLowerCase(); //userAgent 값 얻기
            if (agent.indexOf("android") > -1) {
                return "android";
            } else if (agent.indexOf("iphone") > -1 || agent.indexOf("ipad") > -1 || agent.indexOf("ipod") > -1) {
                return "ios";
            } else {
                return "other";
            }
        }

        function checkBrowser() {
            var agent = navigator.userAgent.toLowerCase(); //userAgent 값 얻기
            if (agent.indexOf("edge") > -1) {
                return "edge";
            } else if (agent.indexOf("chrome") > -1) {
                return "chrome";
            } else if (agent.indexOf("firefox") > -1) {
                return "firefox";
            } else if (agent.indexOf("safari") > -1) {
                return "safari";
            } else {
                return "other";
            }
        }

        function isSafari() {
            return checkBrowser() == "safari";
        }

        function isIOS() {
            return checkMobile() == "ios";
        }

        function isAOS() {
            return checkMobile() == "android";
        }

        function getMetaContentByName(name, content) {
            var content = content == null ? "content" : content;

            var metas = document.getElementsByTagName("meta");

            for (var i = 0; i < metas.length; i++) {
                if (metas[i].getAttribute("property") == name) {
                    return metas[i].getAttribute(content);
                }
            }

            return "";
        }

        function callScheme(url) {
            let iframe = document.createElement("iframe");
            iframe.setAttribute("src", url);
            iframe.setAttribute("height", "1px");
            iframe.setAttribute("width", "1px");
            document.documentElement.appendChild(iframe);
            iframe.parentNode.removeChild(iframe);
            iframe = null;
        }

        function isWebviewClose() {
            alert(typeof onWebviewClose == "function");
        }

        function onWebviewClose() {
            alert("나가고 싶으면 댕댕이를 눌러줘~");
        }

        function scoringCameraResult(base64ImageData) {
            alert("scoringCameraResult");
        }

        function showUserAgent() {
            alert(navigator.userAgent);
        }

        function showAlert(message) {
            if (message == null || message == "") {
                return;
            }
            alert(message);
        }

        function webviewForeground(isFirstCall) {
            console.log("webviewForeground isFirstCall:" + isFirstCall);
        }

        function webviewBackground() {
            console.log("webviewBackground");
        }

        function newWindow() {
            var url = "https://www.nate.com/";
            window.open(url, "", "width=400,height=400,left=600");
        }

        function sendCommonMessage(funcName, value) {
            let newFuncName = "HMGCommonInterface_" + funcName
            debugMessage(newFuncName + " / " + value)
            window.webkit.messageHandlers[newFuncName].postMessage(value);
        }

        function sendOneAppMessage(funcName, value) {
            let newFuncName = "HMGOneAppInterface_" + funcName
            debugMessage(newFuncName + " / " + value)
            window.webkit.messageHandlers[newFuncName].postMessage(value);
        }

        function postClose(message) {
            const str = `{}`;
            sendCommonMessage("close", str)
        }

        function webViewScheme() {
            const targetInput = document.getElementById('targetOpenURL');
            const rawValue = targetInput.value.trim();

            if (rawValue === "") {
                alert('URL을 입력해주세요.');
                return;
            }

            let currentURL;
            try {
                const encodedURL = encodeURIComponent(rawValue);
                currentURL = new URL(`app://webView?url=${encodedURL}`);
            } catch (error) {
                alert('유효하지 않은 URL 형식입니다. 올바른 URL을 입력해주세요.');
                console.error('URL 파싱 오류:', error);
                return;
            }

            const modelCheckbox = document.getElementById('webViewModalCheckbox');
            if (modelCheckbox.checked) {
                currentURL.searchParams.set('isModalEntry', 'true');
            } else {
                currentURL.searchParams.delete('isModalEntry');
            }

            const naviCheckbox = document.getElementById('webViewNaviCheckbox');
            if (naviCheckbox.checked) {
                currentURL.searchParams.set('showNavigationBar', 'true');
            } else {
                currentURL.searchParams.delete('showNavigationBar');
            }

            const toolbarCheckbox = document.getElementById('webViewToolbarCheckbox');
            if (toolbarCheckbox.checked) {
                currentURL.searchParams.set('showToolbar', 'true');
            } else {
                currentURL.searchParams.delete('showToolbar');
            }

            debugMessage(currentURL.toString());
            window.location.href = currentURL.toString();
        }

        function exit() {
            const targetURL = document.getElementById('exitNextOpenURL');
            let str;
            if (targetURL.value !== "") {
                str = `{ "nextScheme": "${targetURL.value}" }`;
            } else {
                str = '{}'
            }
            sendOneAppMessage("exit", str)
        }


        function copyDebugMessageToClipboard() {
            const textarea = document.getElementById('debugMessage');

            textarea.select();
            textarea.setSelectionRange(0, 999999999);

            try {
                document.execCommand('copy');
                alert('복사되었습니다!');
            } catch (err) {
                alert('복사 실패: ' + err);
            }
        }

        function postMessageShowTost(message) {
            const str = `{
			  "message": "JS 토스트 메시지",
			  "durationTime": "long"
			  }`;
            sendCommonMessage("showToast", str)
        }

        function postMessageOpenWebView(url) {
            const str = `{
			  "url": "https://naver.com",
			  "isNavigationBar": false,
			  "isToolBar": true,
			  "appearType": "push"
			}`;
            sendCommonMessage("openWebView", str)
        }

        function postMessageSetBrightness() {
            const str = `{
			  "uid": "123123123",
			  "contents": {"brightness": 1.0},
			  "resultFuncName": "appCallback_cc"
			}`;
            sendCommonMessage("screenBrightness", str)
        }

        function postMessageGetAuthToken() {
            const str = `{
			  "uid": "123123123",
			  "resultFuncName": "appCallback_cc"
			}`;
            sendOneAppMessage("getAuthToken", str)
        }


        function postMessageGetVehicleRegistrationDocumentFile() {
            const str = `{
			  "uid": "123123123",
			  "resultFuncName": "appCallbackVehicleRegistrationDocumentFile_cc",
			  "limitSize": 5
			}`;
            sendOneAppMessage("getVehicleRegistrationDocumentFile", str)
        }

        function postMessageExit() {
            const str = `{"nextScheme":"app://availablevehicles"}`;
            sendOneAppMessage("exit", str)
        }

        function postMessageAgreeTerms() {
            const str = `{"termGroupType":"KR_CCI_TOTAL"}`;
            sendOneAppMessage("agreeTerms", str)
        }

        function setBase64ToImage(base64ImageData) {
            var imgElement = document.getElementById('outputImage');
            imgElement.src = base64ImageData;
            imgElement.alt = 'Extracted Base64 Image';
        }

        function appCallbackVehicleRegistrationDocumentFile_cc(data) {
            var jsonObject = JSON.parse(data);
            var mimeType = jsonObject.result.mimeType;
            var base64Image = "data:" + mimeType + ";base64," + jsonObject.result.base64Data;
            setBase64ToImage(base64Image);

            debugMessage("appCallbackVehicleRegistrationDocumentFile_cc data.length=" + data.length + ", fileName:" + jsonObject.result.name + ", mimeType:" + jsonObject.result.mimeType)
        }

        function appCallback_cc(data) {
            debugMessage(data)
        }

        function onload() {
            debugMessage(navigator.userAgent)
        
            const targetOpenURL = document.getElementById('targetOpenURL');
            if (targetOpenURL) {
                targetOpenURL.value = window.location.href;
            }
        }

        function debugMessage(msg) {
            var element = document.getElementById("debugMessageCount");
            element.innerText = 'message count: ' + msg.length;

            var element = document.getElementById("debugMessage");
            element.innerText = msg;
        }

        function testOpen() {
            var pop = window.open("https://naver.com", false, false)
            const timer = setInterval(function () {
                console.log("pop closed : " + pop.closed);
            }, 1000)
        }

    </script>

</head>

<body onload="onload()">
    <p></p>
    <textarea id="debugMessage" rows="10" cols="50">디버그 메시지 출력</textarea>
    <div id="debugMessageCount"></div>
    <button onclick="copyDebugMessageToClipboard()">디버그 메시지 클립보드에 복사</button>
    <img id="outputImage" />
	
    <p></p>
    <p></p>
    <h3>* 공통 인터페이스</h3>
    <ul>
        <li>
            <a onclick="showUserAgent()">User Agent 확인</a>
        </li>
        <li>
            <a onclick="postClose()">close</a>
        </li>
        <li>
            <a onclick="postMessageShowTost('JS 토스트 테스트')">네이티브에 메시지 전달(ShowTost)</a>
        </li>
        <li>
            <a onclick="postMessageOpenWebView('https://www.naver.com')">네이티브 팝업(ShowTost)</a>
        </li>
        <li>
            <a onclick="postMessageSetBrightness()">postMessageSetBrightness</a>
        </li>
        
    </ul>

    <h3>* URL 관련 인터페이스</h3>
    <ul>
        <li>
            <input type="text" id="targetOpenURL" size="20" />
            <button onclick="webViewScheme()">웹뷰스킴</button>
            <input type="checkbox" id="webViewModalCheckbox"/>
            <label for="webViewModalCheckbox">Modal</label>
            <input type="checkbox" id="webViewNaviCheckbox"/>
            <label for="webViewNaviCheckbox">NavigationBar</label>
            <input type="checkbox" id="webViewToolbarCheckbox"/>
            <label for="webViewToolbarCheckbox">Toolbar</label>
        </li>
        <li>
            <input type="text" id="exitNextOpenURL" size="20" />
            <button onclick="exit()">exit</button>
        </li>
    </ul>

    <p></p>
    <p></p>
    <h3>* 원앱 인터페이스</h3>
    <ul>
        <li>
            <a onclick="postMessageGetAuthToken()">GetAuthToken</a>
        </li>
        <li>
            <a onclick="postMessageGetVehicleRegistrationDocumentFile()">GetVehicleRegistrationDocumentFile</a>
        </li>
        <li>
            <a onclick="postMessageExit()">Exit</a>
        </li>
        <li>
            <a onclick="postMessageAgreeTerms()">AgreeTerms</a>
        </li>
    </ul>

    <p></p>
    <p></p>

    <h3>* 기타</h3>
    <ul>
        <li>
            <input type="button" value="새창열기" onclick="newWindow()" />
        </li>
        <li>
            <a href="tel://01012341234">전화번호1</a>
        </li>
        <li>
            <a href="tel://telprompt">전화번호2</a>
        </li>
        <li>
            <a href="sms://01012341234">SMS</a>
        </li>
        <li>
            <a href="mailto:example@naver.com">MAIL</a>
        </li>
        <li>
            <a onclick="testOpen()">testOpen</a>
        </li>
    </ul>


     <h2>앱 스킴 생성기</h2>
       <label>
    URL 입력:
    <input type="text" id="inputURL" placeholder="https://example.com">
  </label>

  <label>
    <input type="checkbox" id="isModalEntry"> isModalEntry
  </label>
  <label>
    <input type="checkbox" id="showNavigationBar"> showNavigationBar
  </label>
  <label>
    <input type="checkbox" id="showToolbar"> showToolbar
  </label>

  <label>
    동작 선택:
    <select id="actionSelect">
      <option value="none">선택 안 함</option>
      <option value="login">로그인 확인</option>
      <option value="vehicle">차량 확인</option>
    </select>
  </label>

  <label id="needConfirmWrapper" style="display: none;">
    <input type="checkbox" id="needConfirm"> 로그인 팝업 노출
  </label>

  <div id="result">생성된 URL이 여기에 표시됩니다.</div>

  <script>
    const inputURL = document.getElementById('inputURL');
    const isModalEntry = document.getElementById('isModalEntry');
    const showNavigationBar = document.getElementById('showNavigationBar');
    const showToolbar = document.getElementById('showToolbar');
    const actionSelect = document.getElementById('actionSelect');
    const needConfirm = document.getElementById('needConfirm');
    const needConfirmWrapper = document.getElementById('needConfirmWrapper');
    const result = document.getElementById('result');

    function updateURL() {
      const rawURL = inputURL.value.trim();

      if (!rawURL) {
        result.textContent = '생성된 URL이 여기에 표시됩니다.';
        return;
      }

      let baseEncodedURL = encodeURIComponent(rawURL);
      let baseURL = new URL(`app://webView?url=${baseEncodedURL}`);

      if (isModalEntry.checked) {
        baseURL.searchParams.set('isModalEntry', 'true');
      } else {
        baseURL.searchParams.delete('isModalEntry');
      }

      if (showNavigationBar.checked || showToolbar.checked) {
        baseURL.searchParams.set('showNavigationBar', showNavigationBar.checked.toString());
        baseURL.searchParams.set('showToolbar', showToolbar.checked.toString());
      } else {
        baseURL.searchParams.delete('showNavigationBar');
        baseURL.searchParams.delete('showToolbar');
      }

      // 최종 URL (baseURL)을 중첩 래핑할지 결정
      let finalURL = baseURL.toString();
      const selectedAction = actionSelect.value;

      if (selectedAction === "login") {
        const wrapped = new URL("app://login");
        wrapped.searchParams.set("nextUrl", encodeURIComponent(finalURL));
        if (needConfirm.checked) {
          wrapped.searchParams.set("needConfirm", "true");
        }
        finalURL = wrapped.toString();
      } else if (selectedAction === "vehicle") {
        const wrapped = new URL("app://vehicleRequired");
        wrapped.searchParams.set("url", encodeURIComponent(finalURL));
        finalURL = wrapped.toString();
      }

      result.textContent = finalURL;
    }

    // 이벤트 리스너 등록
    inputURL.addEventListener('input', updateURL);
    isModalEntry.addEventListener('change', updateURL);
    showNavigationBar.addEventListener('change', updateURL);
    showToolbar.addEventListener('change', updateURL);
    actionSelect.addEventListener('change', () => {
      const action = actionSelect.value;
      needConfirmWrapper.style.display = action === "login" ? "block" : "none";
      updateURL();
    });
    needConfirm.addEventListener('change', updateURL);
  </script>

</body>

</html>
